import {TouchableOpacity, ActivityIndicator, StyleSheet, SafeAreaView, Image, ScrollView, FlatList, Text, View} from 'react-native';
import { Avatar, Overlay, Button, Header} from "react-native-elements";
import React, { Component, useEffect, useState, useCallback, useContext } from "react";
import { NavigationContainer } from '@react-navigation/native';
import axios from 'axios';
 import Svg, {
  Circle,
  Ellipse,
  G,
  TSpan,
  TextPath,
  SvgXml,
  Path,
  Polygon,
  Polyline,
  Line,
  Rect,
  Use,
  Symbol,
  Defs,
  LinearGradient,
  RadialGradient,
  Stop,
  ClipPath,
  Pattern,
  Mask,
} from 'react-native-svg';
import AsyncStorage from '@react-native-async-storage/async-storage';

import { ThemeContext } from '../../Contexts/theme-context';

// !!!! VARIABLE TO CHANGE IP ADDRESS !!!! //

const ip_address = "10.0.0.110:3000";

// !!!! VARIABLE TO CHANGE IP ADDRESS !!!! //

const FriendHeader2 = (props) => {
  const { dark, sport, theme, toggle, sportToggle, setSport} = useContext(ThemeContext);
  const [uidNumber, setuidNumber] = useState("");
  const [first, setFirst] = useState("");
  const [last, setLast] = useState("");
  const [loading, setLoading] = useState(true);

  // AysncStorage call to get these parameters
  useEffect(() => {
      AsyncStorage.getItem('id').then((uidNumber) => {
          if(uidNumber){
              setuidNumber(uidNumber);
          }
      });
      AsyncStorage.getItem('fName').then((first) => {
          if(first){
            setFirst(first.replace(/['"]+/g, ''));
          }
      });
      AsyncStorage.getItem('lName').then((last) => {
          if(last){
            setLast(last.replace(/['"]+/g, ''));
          }
      });
  });
    const updateUrl = 'http://' + ip_address + '/v1/user_friends/' + uidNumber + "/" +props.itemId;

  const handleOnPress = () => {
   console.log('Cancelled');
        fetch(updateUrl, {
            method: "DELETE",
            body: JSON.stringify({
              userId: props.listUserId,
              friendUserId: props.listId
            }),
            headers: {
                Accept: "application/json",
                "Content-Type": "application/json",
            },
        })
            .then((response) => response.json())
            .then((responseJson) => {
                console.log(responseJson);
                setLoading(false);
            })
            .catch((error) => {
                setLoading(false);
                console.error(error);
            });

            if(!loading) {
              props.navigationProps.pop()
            }
  }
  return (
    <View>
      <TouchableOpacity
          style={{
            shadowColor: "#000",
              shadowOffset: {
                width: 0,
                height: 1,
              },
              shadowOpacity: 0.22,
              shadowRadius: 2.22,
                            paddingRight: "5%",


              elevation: 3,
          }}
                onPress={handleOnPress}

        >
        {/* !!!! translate svg sizes to adaptive sieze !!!! */}
        <Svg width="132" height="34" fill="none">
          <Rect width="132" height="34" rx="17" fill={theme.editProfileButton} />
          <Path
                    d= "M39.5179 17.7369H37.8776V21H36.406V12.531H39.3841C40.3613 12.531 41.1155 12.7501 41.6468 13.1883C42.178 13.6265 42.4437 14.2605 42.4437 15.0903C42.4437 15.6565 42.306 16.1315 42.0307 16.5154C41.7592 16.8954 41.3792 17.1882 40.8906 17.3937L42.7926 20.9244V21H41.2163L39.5179 17.7369ZM37.8776 16.5561H39.3899C39.8863 16.5561 40.2741 16.432 40.5533 16.1838C40.8325 15.9318 40.9721 15.5886 40.9721 15.1543C40.9721 14.7006 40.8421 14.3497 40.5823 14.1015C40.3264 13.8533 39.9425 13.7254 39.4307 13.7176H37.8776V16.5561ZM46.4746 21.1163C45.5788 21.1163 44.8517 20.8352 44.2933
 20.2729C43.7388 19.7068 43.4616 18.9545 43.4616 18.0161V17.8416C43.4616 17.2134 43.5818 16.6531 43.8222 16.1606C44.0665 15.6642 44.4077 15.2784 44.8459 15.0031C45.2841 14.7278 45.7727 14.5901 46.3117 14.5901C47.1687 14.5901 47.8298 14.8635 48.2952 15.4102C48.7644 15.957 48.999 16.7306 48.999 17.7311V18.3011H44.8866C44.9293 18.8207 45.1018 19.2318 45.4043 19.5342C45.7106 19.8367 46.0945 19.9879 46.556 19.9879C47.2036 19.9879 47.7309 19.7262 48.1381 19.2027L48.9001 19.9297C48.648 20.3059 48.3107 20.5987 47.888 20.8081C47.4692 21.0136 46.9981 21.1163 46.4746 21.1163ZM46.3059
  15.7243C45.9181 15.7243 45.604 15.8601 45.3636 16.1315C45.127 16.4029 44.9758 16.781 44.9099 17.2657H47.603V17.161C47.572 16.688 47.4459 16.3312 47.2249 16.0908C47.0039 15.8465 46.6975 15.7243 46.3059 15.7243ZM51.4303 14.7064L51.471 15.3637C51.9131 14.848 52.518 14.5901 53.2858 14.5901C54.1273 14.5901 54.7031 14.912 55.0133 15.5557C55.4709 14.912 56.1146 14.5901 56.9445 14.5901C57.6386 14.5901 58.1543 14.782 58.4917 15.1659C58.8329 15.5498 59.0074 16.116 59.0152 16.8644V21H57.6017V16.9051C57.6017 16.5057 57.5145 16.2129 57.34 16.0268C57.1655 15.8407 56.8766 15.7476
 56.4733 15.7476C56.1515 15.7476 55.8878 15.8349 55.6822 16.0094C55.4806 16.18 55.3391 16.4049 55.2576 16.6841L55.2635 21H53.85V16.8586C53.8306 16.1179 53.4526 15.7476 52.7158 15.7476C52.1496 15.7476 51.7483 15.9783 51.5117 16.4398V21H50.0983V14.7064H51.4303ZM60.2018 17.795C60.2018 17.1785 60.3239 16.624 60.5682 16.1315C60.8125 15.6352 61.1557 15.2551 61.5977 14.9914C62.0398 14.7239 62.5478 14.5901 63.1217 14.5901C63.9709 14.5901 64.6592 14.8635 65.1866 15.4102C65.7178 15.957 66.0048 16.6821 66.0474 17.5857L66.0533 17.9172C66.0533 18.5376 65.933 19.0922 65.6926 19.5807C65.4561
  20.0693 65.1148 20.4474 64.6689 20.715C64.2268 20.9826 63.715 21.1163 63.1333 21.1163C62.2453 21.1163 61.5338 20.8216 60.9986 20.2322C60.4674 19.6389 60.2018 18.8498 60.2018 17.8648V17.795ZM61.6152 17.9172C61.6152 18.5648 61.749 19.0728 62.0165 19.4411C62.2841 19.8057 62.6564 19.9879 63.1333 19.9879C63.6103 19.9879 63.9806 19.8018 64.2443 19.4295C64.5119 19.0573 64.6456 18.5124 64.6456 17.795C64.6456 17.1591 64.508 16.655 64.2327 16.2827C63.9612 15.9105 63.5909 15.7243 63.1217 15.7243C62.6602 15.7243 62.2938 15.9085 62.0224 16.2769C61.7509 16.6414 61.6152 17.1882 61.6152 17.9172ZM69.3745
   19.2085L70.7065 14.7064H72.1665L69.9853 21H68.758L66.5593 14.7064H68.0251L69.3745 19.2085ZM75.7437 21.1163C74.848 21.1163 74.1209 20.8352 73.5625 20.2729C73.008 19.7068 72.7307 18.9545 72.7307 18.0161V17.8416C72.7307 17.2134 72.8509 16.6531 73.0914 16.1606C73.3356 15.6642 73.6769 15.2784 74.1151 15.0031C74.5533 14.7278 75.0419 14.5901 75.5809 14.5901C76.4378 14.5901 77.099 14.8635 77.5643 15.4102C78.0335 15.957 78.2681 16.7306 78.2681 17.7311V18.3011H74.1558C74.1984 18.8207 74.371 19.2318 74.6735 19.5342C74.9798 19.8367 75.3637 19.9879
  75.8252 19.9879C76.4727 19.9879 77.0001 19.7262 77.4073 19.2027L78.1692 19.9297C77.9172 20.3059 77.5798 20.5987 77.1572 20.8081C76.7384 21.0136 76.2672 21.1163 75.7437 21.1163ZM75.575 15.7243C75.1873 15.7243 74.8732 15.8601 74.6328 16.1315C74.3962 16.4029 74.245 16.781 74.1791 17.2657H76.8721V17.161C76.8411 16.688 76.7151 16.3312 76.4941 16.0908C76.273 15.8465 75.9667 15.7243 75.575 15.7243ZM87.3537 17.4112H83.9451V21H82.4735V12.531H87.8539V13.7176H83.9451V16.2362H87.3537V17.4112ZM92.0302 15.9977C91.8441 15.9667 91.6521 15.9512 91.4544 15.9512C90.8068
   15.9512 90.3706 16.1994 90.1456 16.6957V21H88.7322V14.7064H90.0817L90.1166 15.4102C90.4578 14.8635 90.9309 14.5901 91.5358 14.5901C91.7375 14.5901 91.9042 14.6172 92.036 14.6715L92.0302 15.9977ZM94.4267 21H93.0132V14.7064H94.4267V21ZM92.926 13.072C92.926 12.8548 92.9938 12.6745 93.1296 12.531C93.2692 12.3875 93.4669 12.3158 93.7228 12.3158C93.9788 12.3158 94.1765 12.3875 94.3161 12.531C94.4557 12.6745 94.5255 12.8548 94.5255 13.072C94.5255 13.2852 94.4557 13.4636 94.3161 13.6071C94.1765 13.7467 93.9788 13.8165 93.7228 13.8165C93.4669 13.8165 93.2692
    13.7467 93.1296 13.6071C92.9938 13.4636 92.926 13.2852 92.926 13.072ZM98.7426 21.1163C97.8468 21.1163 97.1198 20.8352 96.5614 20.2729C96.0068 19.7068 95.7296 18.9545 95.7296 18.0161V17.8416C95.7296 17.2134 95.8498 16.6531 96.0902 16.1606C96.3345 15.6642 96.6757 15.2784 97.1139 15.0031C97.5521 14.7278 98.0407 14.5901 98.5797 14.5901C99.4367 14.5901 100.098 14.8635 100.563 15.4102C101.032 15.957 101.267 16.7306 101.267 17.7311V18.3011H97.1547C97.1973 18.8207 97.3699 19.2318 97.6723 19.5342C97.9787 19.8367 98.3626 19.9879 98.824 19.9879C99.4716 19.9879 99.999 19.7262 100.406 19.2027L101.168 19.9297C100.916
   20.3059 100.579 20.5987 100.156 20.8081C99.7372 21.0136 99.2661 21.1163 98.7426 21.1163ZM98.5739 15.7243C98.1861 15.7243 97.872 15.8601 97.6316 16.1315C97.3951 16.4029 97.2438 16.781 97.1779 17.2657H99.871V17.161C99.84 16.688 99.714 16.3312 99.4929 16.0908C99.2719 15.8465 98.9656 15.7243 98.5739 15.7243ZM103.681 14.7064L103.722 15.4335C104.187 14.8712 104.798 14.5901 105.554 14.5901C106.865 14.5901 107.531 15.3404 107.555 16.8411V21H106.141V16.9226C106.141 16.5232 106.054 16.2284 105.88 16.0384C105.709 15.8445 105.428 15.7476 105.036 15.7476C104.466 15.7476 104.042 16.0055 103.762 16.5212V21H102.349V14.7064H103.681ZM108.736
    17.8067C108.736 16.8372 108.96 16.0598 109.41 15.4742C109.86 14.8848 110.463 14.5901 111.219 14.5901C111.886 14.5901 112.425 14.8228 112.836 15.2881V12.0657H114.25V21H112.97L112.9 20.3485C112.478 20.8604 111.913 21.1163 111.208 21.1163C110.471 21.1163 109.874 20.8197 109.416 20.2264C108.962 19.6331 108.736 18.8265 108.736 17.8067ZM110.149 17.9288C110.149 18.5687 110.271 19.0689 110.515 19.4295C110.764 19.7863 111.115 19.9646 111.568 19.9646C112.146 19.9646 112.569 19.7068 112.836 19.191V16.5038C112.576 15.9997 112.158 15.7476 111.58 15.7476C111.122 15.7476 110.769 15.9299 110.521 16.2944C110.273 16.655 110.149 17.1998 110.149 17.9288Z"
                            fill= {theme.editOutline}
                />

                <Path d="M20.8757 17.0339L23.8527 14.0592C23.9531 13.9421 24.0055 13.7915 23.9995 13.6374C23.9936 13.4834 23.9297 13.3373 23.8206 13.2282C23.7115 13.1192 23.5653 13.0554 23.4111 13.0494C23.2569 13.0435 23.1062 13.0959 22.989 13.1961L20.012 16.1403L17.0166 13.1472C16.8994
                 13.0469 16.7486 12.9945 16.5945 13.0005C16.4403 13.0064 16.2941 13.0703 16.185 13.1793C16.0759 13.2883 16.012 13.4344 16.006 13.5885C16.0001 13.7425 16.0525 13.8931 16.1529 14.0102L19.1421 17.0339L16.2141 19.923C16.15 19.9779 16.0979 20.0454 16.0611 20.1213C16.0244 20.1973 16.0037 20.28
                 16.0005 20.3643C15.9972 20.4486 16.0114 20.5326 16.0422 20.6112C16.073 20.6897 16.1197 20.7611 16.1794 20.8207C16.2391 20.8804 16.3105 20.9271 16.3891 20.9578C16.4677 20.9886 16.5518 21.0028 16.6362 20.9995C16.7206 20.9963 16.8033 20.9756 16.8793 20.9389C16.9553 20.9022
                  17.0229 20.8501 17.0778 20.786L19.9997 17.8664L22.9032 20.7677C23.0204 20.868 23.1712 20.9204 23.3253 20.9144C23.4795 20.9085 23.6257 20.8446 23.7348 20.7356C23.8439 20.6266 23.9078 20.4805 23.9138 20.3264C23.9197 20.1724 23.8673 20.0217 23.7669 19.9046L20.8757 17.0339Z" stroke= { theme.friendText} strokeWidth="1.48905" strokeLinecap="round" strokeLinejoin="round"/>
          </Svg>
        </TouchableOpacity>
    </View>
  );
};
export default FriendHeader2;


